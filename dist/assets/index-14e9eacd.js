import{_ as W,e as X,a as K}from"./exportExcel-ea569a47.js";import{J as Z,d as ee,u as te,r,S as le,G as oe,y as ae,e as i,o as m,f as z,g as a,w as s,h as d,j as T,v as N,n as se,m as G,C as k,F as D,q as re,_ as ne}from"./index-c7a0cc4e.js";import{V as ie}from"./vue-draggable-next.esm-bundler-8be8cb1d.js";const de=(x,v,u)=>Z.post(`/admin/pur/getpurtab/${x}/${v}`,u),ue={id:"elcheckbox"},pe={class:"basicEx"},he=ee({__name:"index",setup(x){let v=te(),u=r(1),c=r(10),B=r(0),V=r([]),p=r([]);le(()=>{localStorage.getItem("purtabTableFilter")?(p.value=JSON.parse(localStorage.getItem("purtabTableFilter")||""),w(p.value)):p.value=n.value.map(o=>o.label)}),oe(async()=>{await b()});let U=r(v.buttons.includes("btn.purtab.confirm"));const f=r("1"),_=r(window.innerHeight-316),C=[Object.assign({},{id:"1",index:1,condition:"equal",operate:"and",field:"",value:"",header:!0,checked:!0,pid:-1,floor:1})];let A=1;const I=[{key:"请购单别",val:"TB001"},{key:"请购单号",val:"TB002"},{key:"请购序号",val:"TB003"},{key:"品号",val:"TB004"},{key:"品名",val:"PM"},{key:"规格",val:"GG"},{key:"请购日期",val:"TA003"},{key:"结束码",val:"TB039"},{key:"审核码",val:"TB025"}],O={TB025:{dom:"select",data:[{key:"已审核",val:"Y"},{key:"未审核",val:"N"},{key:"审核失败",val:"U"},{key:"作废",val:"V"}]},TB039:{dom:"select",data:[{key:"自动结束",val:"Y"},{key:"未结束",val:"N"},{key:"指定结束",val:"y"}]},TA003:{dom:"date"}},P=()=>{b()},b=async(o=1)=>{u.value=o;let e={conditions:[{}]};e.conditions.splice(0,1),C.forEach(h=>{e.conditions.push(h)});let l=await de(u.value,c.value,e);l.code==200&&(B.value=l.data.total,l.data.records.forEach((h,y)=>{h.index=y+1+(u.value-1)*c.value}),V.value=l.data.records)},F=()=>{b()},n=r([{strlen:18,label:"请购单号",prop:"QGDH",width:170,vhide:!0,orderby:!0,isShow:!0,sort:0},{strlen:12,label:"品号",prop:"TB004",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"品名",prop:"PM",width:150,vhide:!0,isShow:!0,sort:0},{strlen:15,label:"规格",prop:"GG",width:230,vhide:!0,isShow:!0,sort:0},{strlen:5,label:"请购数量",prop:"TB009",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"单位",prop:"TB007",width:65,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"请购日期",prop:"TA003",width:100,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"请购部门",prop:"ME002",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"请购人员",prop:"QGRY",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"需求日期",prop:"TB011",width:100,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"备注",prop:"TB012",width:120,vhide:!1,isShow:!0,sort:0},{strlen:8,label:"采购人员",prop:"CGRY",width:85,vhide:!0,isShow:!0,sort:0},{strlen:5,label:"采购数量",prop:"TB014",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"采购单位",prop:"TB015",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"采购币种",prop:"TB016",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"采购单价",prop:"TB017",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"采购金额",prop:"TB018",width:120,vhide:!0,isShow:!0,sort:0},{strlen:5,label:"交货日",prop:"TB019",width:100,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"锁定码",prop:"TB020",width:75,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"采购单号",prop:"TB022",width:180,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"审核码",prop:"TB025",width:75,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"结束码",prop:"TB039",width:75,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"计价单位",prop:"TB043",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"计价数量",prop:"TB044",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"采购总数量",prop:"TB045",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"采购总金额",prop:"TB046",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"计划批号",prop:"TB057",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"计划版本",prop:"TB058",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"计划序号",prop:"TB059",width:120,vhide:!1,isShow:!0,sort:0}]),R=["TD039","TD035","TD035"],q=(o,e)=>(o.rowIndex+1)%2===0?"oddRow":"evenRow";ae(f,(o,e)=>{f.value=="1"?_.value=window.innerHeight-316:_.value=window.innerHeight-228});const w=o=>{n.value.forEach(l=>{o.indexOf(l.label)!=-1?(l.isShow=!0,l.sort=o.indexOf(l.label)-o.length):l.isShow=!1}),n.value.sort((l,h)=>l.sort-h.sort),localStorage.setItem("purtabTableFilter",JSON.stringify(o));const e=o.length;g.value=e===n.value.length,S.value=e>0&&e<n.value.length},g=r(!1),S=r(!1),M=o=>{p.value=o?n.value.map(e=>e.label):[],S.value=!1,w(p.value)};return(o,e)=>{const l=i("el-button"),h=i("el-card"),y=i("el-collapse-item"),H=i("el-collapse"),Y=i("Grid"),E=i("el-checkbox"),j=i("el-checkbox-group"),J=i("el-popover"),L=i("el-icon"),Q=i("el-pagination");return m(),z(D,null,[a(H,{modelValue:f.value,"onUpdate:modelValue":e[0]||(e[0]=t=>f.value=t)},{default:s(()=>[a(y,{title:"查询条件",name:"1",style:{}},{default:s(()=>[a(h,{class:"form",style:{}},{default:s(()=>[a(W,{floor:d(A),conditionList:C,"key-list":I,"val-list":O},null,8,["floor"]),a(l,{type:"primary",size:"default",onClick:P},{default:s(()=>[T("查询")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(h,{style:{margin:"10px 0px"}},{default:s(()=>[d(v).buttons.includes("btn.purtab.exportexcel")?(m(),N(l,{key:0,type:"primary",size:"default",onClick:e[1]||(e[1]=t=>d(X)("请购单信息.xlsx","#purtab-table"))},{default:s(()=>[T("导出EXCEL")]),_:1})):se("",!0),a(L,{size:20,style:{float:"right","font-size":"33px","padding-right":"50px"},class:"grid"},{default:s(()=>[a(J,{placement:"bottom",trigger:"hover",width:"80"},{reference:s(()=>[a(l,null,{default:s(()=>[a(Y)]),_:1})]),default:s(()=>[G("div",ue,[G("div",pe,[a(E,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=t=>g.value=t),indeterminate:S.value,onChange:M},{default:s(()=>[T("全选")]),_:1},8,["modelValue","indeterminate"])]),a(j,{modelValue:d(p),"onUpdate:modelValue":e[4]||(e[4]=t=>k(p)?p.value=t:p=t),onChange:w,class:"checkbox-wrap"},{default:s(()=>[a(d(ie),{modelValue:n.value,"onUpdate:modelValue":e[3]||(e[3]=t=>n.value=t),onEnd:w},{default:s(()=>[(m(!0),z(D,null,re(n.value,(t,$)=>(m(),N(E,{key:$,label:t.label,size:"large",style:{display:"block"}},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])]),_:1})]),_:1}),a(K,{id:"purtcd-table",tableData:d(V),height:_.value,columns:n.value,sumArray:R,"row-class-name":q,checkVhide:!1,butPremission:d(U)},null,8,["tableData","height","columns","butPremission"]),a(Q,{"current-page":d(u),"onUpdate:currentPage":e[5]||(e[5]=t=>k(u)?u.value=t:u=t),"page-size":d(c),"onUpdate:pageSize":e[6]||(e[6]=t=>k(c)?c.value=t:c=t),"page-sizes":[10,30,100,500,2e3],background:!0,layout:"prev, pager, next, jumper,->,sizes,total",total:d(B),onCurrentChange:b,onSizeChange:F},null,8,["current-page","page-size","total"])]),_:1})],64)}}});const we=ne(he,[["__scopeId","data-v-6c3fd657"]]);export{we as default};
