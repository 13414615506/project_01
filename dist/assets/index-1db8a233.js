import{_ as de,e as ie,a as ue}from"./exportExcel-ea569a47.js";import{J as L,d as pe,r as p,S as me,G as ve,y as fe,c as K,e as d,o as H,f as G,g as l,w as a,h as o,j as g,m as y,C as k,F as O,q as he,v as be,_ as we}from"./index-c7a0cc4e.js";const ce=(c,m,b)=>L.post(`/admin/inv/getinvmb/${c}/${m}`,b),ge=(c,m)=>L.get(`/admin/inv/getInventory/${c}/${m}`),ye=c=>L.get(`/admin/inv/getInventoryBusiness/${c}`),_e={id:"elcheckbox"},Ve={class:"basicEx"},Se={class:"form-top"},Be={class:"form-top--left"},xe={class:"form-top--right"},Je={class:"my-dialog"},Me=pe({__name:"index",setup(c){let m=p(1),b=p(50),I=p(0),U=p([]),f=p([]);me(()=>{localStorage.getItem("invmbTableFilter")?(f.value=JSON.parse(localStorage.getItem("invmbTableFilter")||""),S(f.value)):f.value=v.value.map(s=>s.label)}),ve(async()=>{await V()});const _=p("1"),J=p(window.innerHeight-316),D=[Object.assign({},{id:"1",index:1,condition:"equal",operate:"and",field:"",value:"",header:!0,checked:!0,pid:-1,floor:1})];let F=1;const T=[{key:"品号",val:"MB001"},{key:"品名",val:"MB002"},{key:"规格",val:"MB003"},{key:"库存数量",val:"MB064"},{key:"库存金额",val:"MB065"},{key:"存货管理",val:"MB019"},{key:"核准状况",val:"MB109"},{key:"生效日期",val:"MB030"}],q={MB019:{dom:"select",data:[{key:"是",val:"Y"},{key:"否",val:"N"}]},MB109:{dom:"select",data:[{key:"已核准",val:"Y"},{key:"尚待核准",val:"y"},{key:"不准交易",val:"N"}]},MB030:{dom:"date"}},$=()=>{V()},V=async(s=1)=>{m.value=s;let e={conditions:[{}]};e.conditions.splice(0,1),D.forEach(w=>{e.conditions.push(w)});let r=await ce(m.value,b.value,e);r.code==200&&(I.value=r.data.total,r.data.records.forEach((w,C)=>{w.index=C+1+(m.value-1)*b.value}),U.value=r.data.records)},A=async(s,e)=>{let r=await ge(s,e);r.code==200&&(n=r.data,B.value=!0)},P=async s=>{let e=await ye(s);e.code==200&&(z=e.data,x.value=!0)},Q=()=>{V()},v=p([{strlen:10,label:"品号",prop:"MB001",width:120,vhide:!1,orderby:!0,isShow:!0,sort:0},{strlen:5,label:"品名",prop:"MB002",width:120,vhide:!0,isShow:!0,sort:0},{strlen:10,label:"规格",prop:"MB003",width:230,vhide:!0,isShow:!0,sort:0},{strlen:5,label:"品号分类",prop:"MB005",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"主要仓库",prop:"MB017",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"库存单位",prop:"MB004",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"存货管理",prop:"MB019",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"品号属性",prop:"MB025",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"补货政策",prop:"MB034",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"补货周期",prop:"MB035",width:85,vhide:!1,isShow:!0,sort:0},{strlen:8,label:"固定前置天数",prop:"MB036",width:110,vhide:!0,isShow:!0,sort:0},{strlen:5,label:"变动前置天数",prop:"MB037",width:110,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"批量",prop:"MB038",width:60,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"最低补量",prop:"MB039",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"补货倍量",prop:"MB040",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"领用倍量",prop:"MB041",width:85,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"领料码",prop:"MB042",width:65,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"单位标准材料成本",prop:"MB037",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"单位标准人工成本",prop:"MB058",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"单位标准制造费用",prop:"MB059",width:180,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"单位标准加工费用",prop:"MB060",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"本阶人工",prop:"MB061",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"本阶制费",prop:"MB062",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"本阶加工",prop:"MB063",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"库存数量",prop:"MB064",width:120,vhide:!1,orderby:!0,isShow:!0,sort:0},{strlen:5,label:"库存金额",prop:"MB065",width:120,vhide:!1,orderby:!0,isShow:!0,sort:0},{strlen:5,label:"更改品名规格",prop:"MB066",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"工作中心",prop:"MB068",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"品号类别",prop:"MB077",width:120,vhide:!1,isShow:!0,sort:0},{strlen:5,label:"picture",prop:"MB143",width:120,vhide:!1,isShow:!0,sort:0},{strlen:18,label:"库存状况",prop:"",width:220,vhide:!1,isShow:!0,sort:0}]),R=["MB064","MB065"],E=(s,e)=>(s.rowIndex+1)%2===0?"oddRow":"evenRow";fe(_,(s,e)=>{_.value=="1"?J.value=window.innerHeight-316:J.value=window.innerHeight-228});const S=s=>{v.value.forEach(r=>{s.includes(r.label)?(r.isShow=!0,r.sort=s.indexOf(r.label)-s.length):r.isShow=!1}),v.value.sort((r,w)=>r.sort-w.sort),localStorage.setItem("invmbTableFilter",JSON.stringify(s));const e=s.length;M.value=e===v.value.length,Y.value=e>0&&e<v.value.length},M=p(!1),Y=p(!1),j=s=>{f.value=s?v.value.map(e=>e.label):[],Y.value=!1,S(f.value)},B=p(!1),x=p(!1);let n=K({PH:"123456",YJQG:0,YJJH:0,YJSC:0,YJLY:0,YJXH:0,KCSL:0,YJKY:0,JHCG:0,JHSC:0,JHLY:0,JHXH:0,JHKY:0,DYSL:0,DLSL:0,DXSL:0}),z=K([]);return(s,e)=>{const r=d("el-button"),w=d("el-card"),C=d("el-collapse-item"),W=d("el-collapse"),Z=d("Grid"),N=d("el-checkbox"),ee=d("VueDraggableNext"),le=d("el-checkbox-group"),te=d("el-popover"),oe=d("el-icon"),ae=d("el-pagination"),i=d("el-input"),u=d("el-form-item"),ne=d("el-form"),X=d("el-dialog"),h=d("el-table-column"),re=d("el-table");return H(),G(O,null,[l(W,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=t=>_.value=t)},{default:a(()=>[l(C,{title:"查询条件",name:"1",style:{}},{default:a(()=>[l(w,{class:"form",style:{}},{default:a(()=>[l(de,{floor:o(F),conditionList:D,"key-list":T,"val-list":q},null,8,["floor"]),l(r,{type:"primary",size:"default",onClick:$},{default:a(()=>[g("查询")]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(w,{style:{margin:"10px 0px"}},{default:a(()=>[l(r,{type:"primary",size:"default"},{default:a(()=>[g("添加品号")]),_:1}),l(r,{type:"primary",size:"default",onClick:e[1]||(e[1]=t=>o(ie)("品号信息.xlsx","#invmb-table"))},{default:a(()=>[g("导出EXCEL")]),_:1}),l(oe,{size:20,style:{float:"right","font-size":"33px","padding-right":"50px"},class:"grid"},{default:a(()=>[l(te,{placement:"bottom",trigger:"hover",width:"80"},{reference:a(()=>[l(r,null,{default:a(()=>[l(Z)]),_:1})]),default:a(()=>[y("div",_e,[y("div",Ve,[l(N,{modelValue:M.value,"onUpdate:modelValue":e[2]||(e[2]=t=>M.value=t),indeterminate:Y.value,onChange:j},{default:a(()=>[g("全选")]),_:1},8,["modelValue","indeterminate"])]),l(le,{modelValue:o(f),"onUpdate:modelValue":e[4]||(e[4]=t=>k(f)?f.value=t:f=t),onChange:S,class:"checkbox-wrap"},{default:a(()=>[l(ee,{modelValue:v.value,"onUpdate:modelValue":e[3]||(e[3]=t=>v.value=t),onEnd:S},{default:a(()=>[(H(!0),G(O,null,he(v.value,(t,se)=>(H(),be(N,{key:se,label:t.label,size:"large",style:{display:"block"}},null,8,["label"]))),128))]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])])]),_:1})]),_:1}),l(ue,{id:"invmb-table",tableData:o(U),height:J.value,columns:v.value,sumArray:R,"row-class-name":E,checkVhide:!0,butPremission:!0,onInvmbShowInventory:A,onInvmbShowInventoryBusiness:P},null,8,["tableData","height","columns"]),l(ae,{"current-page":o(m),"onUpdate:currentPage":e[5]||(e[5]=t=>k(m)?m.value=t:m=t),"page-size":o(b),"onUpdate:pageSize":e[6]||(e[6]=t=>k(b)?b.value=t:b=t),"page-sizes":[10,30,100,500,2e3],background:!0,layout:"prev, pager, next, jumper,->,sizes,total",total:o(I),onCurrentChange:V,onSizeChange:Q},null,8,["current-page","page-size","total"])]),_:1}),l(X,{modelValue:B.value,"onUpdate:modelValue":e[23]||(e[23]=t=>B.value=t),style:{width:"420px"},title:"查询库存状况"},{footer:a(()=>[l(r,{type:"primary",size:"default",onClick:e[22]||(e[22]=t=>B.value=!1)},{default:a(()=>[g("关闭")]),_:1})]),default:a(()=>[l(ne,{class:"elInventory",model:o(n),ref:"form"},{default:a(()=>[y("div",Se,[y("div",Be,[l(u,{label:"预计请购",prop:"YJQG"},{default:a(()=>[l(i,{modelValue:o(n).YJQG,"onUpdate:modelValue":e[7]||(e[7]=t=>o(n).YJQG=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"预计进货",prop:"YJJH"},{default:a(()=>[l(i,{modelValue:o(n).YJJH,"onUpdate:modelValue":e[8]||(e[8]=t=>o(n).YJJH=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"预计生产",prop:"YJSC"},{default:a(()=>[l(i,{modelValue:o(n).YJSC,"onUpdate:modelValue":e[9]||(e[9]=t=>o(n).YJSC=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"计划采购",prop:"JHCG"},{default:a(()=>[l(i,{modelValue:o(n).JHCG,"onUpdate:modelValue":e[10]||(e[10]=t=>o(n).JHCG=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"计划生产",prop:"JHSC"},{default:a(()=>[l(i,{modelValue:o(n).JHSC,"onUpdate:modelValue":e[11]||(e[11]=t=>o(n).JHSC=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"预计可用",prop:"YJKY"},{default:a(()=>[l(i,{modelValue:o(n).YJKY,"onUpdate:modelValue":e[12]||(e[12]=t=>o(n).YJKY=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"计划可用",prop:"JHKY"},{default:a(()=>[l(i,{modelValue:o(n).JHKY,"onUpdate:modelValue":e[13]||(e[13]=t=>o(n).JHKY=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"库存数量",prop:"KCSL"},{default:a(()=>[l(i,{modelValue:o(n).KCSL,"onUpdate:modelValue":e[14]||(e[14]=t=>o(n).KCSL=t),readonly:""},null,8,["modelValue"])]),_:1})]),y("div",xe,[l(u,{label:"预计领用",prop:"YJLY"},{default:a(()=>[l(i,{modelValue:o(n).YJLY,"onUpdate:modelValue":e[15]||(e[15]=t=>o(n).YJLY=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"预计销货",prop:"YJXH"},{default:a(()=>[l(i,{modelValue:o(n).YJXH,"onUpdate:modelValue":e[16]||(e[16]=t=>o(n).YJXH=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"计划领用",prop:"JHLY"},{default:a(()=>[l(i,{modelValue:o(n).JHLY,"onUpdate:modelValue":e[17]||(e[17]=t=>o(n).JHLY=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"计划销货",prop:"JHXH"},{default:a(()=>[l(i,{modelValue:o(n).JHXH,"onUpdate:modelValue":e[18]||(e[18]=t=>o(n).JHXH=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"待领用量",prop:"DLSL"},{default:a(()=>[l(i,{modelValue:o(n).DLSL,"onUpdate:modelValue":e[19]||(e[19]=t=>o(n).DLSL=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"待销货量",prop:"DXSL"},{default:a(()=>[l(i,{modelValue:o(n).DXSL,"onUpdate:modelValue":e[20]||(e[20]=t=>o(n).DXSL=t),readonly:""},null,8,["modelValue"])]),_:1}),l(u,{label:"待验收量",prop:"DYSL"},{default:a(()=>[l(i,{modelValue:o(n).DYSL,"onUpdate:modelValue":e[21]||(e[21]=t=>o(n).DYSL=t),readonly:""},null,8,["modelValue"])]),_:1})])])]),_:1},8,["model"])]),_:1},8,["modelValue"]),y("div",Je,[l(X,{modelValue:x.value,"onUpdate:modelValue":e[25]||(e[25]=t=>x.value=t),style:{width:"920px",height:"480px"},title:"未来交易量",class:"my-dialog"},{footer:a(()=>[l(r,{type:"primary",size:"default",onClick:e[24]||(e[24]=t=>x.value=!1)},{default:a(()=>[g("关闭")]),_:1})]),default:a(()=>[l(re,{style:{margin:"5px 0px",height:"300px"},border:"",data:o(z),"row-class-name":E,"highlight-current-row":""},{default:a(()=>[l(h,{label:"#",align:"center",type:"index",width:"65px",fixed:""}),l(h,{label:"日期",align:"center",prop:"TD012",width:"110px"}),l(h,{label:"异动别",align:"center",prop:"TYPE",width:"70px"}),l(h,{label:"入库数量",align:"center",prop:"INFIELD",width:"85px"}),l(h,{label:"出库数量",align:"center",prop:"OUTFIELD",width:"85px"}),l(h,{label:"仓库",align:"center",prop:"MC001",width:"70px"}),l(h,{label:"仓库名称",align:"center",prop:"MC002",width:"85px"}),l(h,{label:"备注",align:"center",prop:"MEMO",width:"320px"}),l(h,{label:"备注",align:"center",prop:"MEMO",width:"320px"})]),_:1},8,["data"])]),_:1},8,["modelValue"])])],64)}}});const ke=we(Me,[["__scopeId","data-v-22ca9e43"]]);export{ke as default};
